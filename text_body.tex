\section{Introduction}
The theoretical and experimental study of structural dynamics has regularly helped engineers grasp the behaviour of systems and structures encountered in everyday life, and has consequently aided in making them safer, lighter, and greener. This ranges from the design of airplanes and cars to the stability of buildings as well as the functionality of household appliances like washing machines or air conditioners. Hence, engineers and researchers have been consistently striving to further understand and predict the dynamic characteristics of these various structures. This understanding is crucial for ensuring safety and compliance, performance, and reliability

\subsection{Modal Analysis}
\subsubsection{Theoretical Overview}
In \emph{linear} structural dynamics, \emph{Modal Analysis} is universally recognized as the pre-eminent solution for the identifying and characterizing structures or systems. It achieves this by studying the structure's \emph{modal properties or parameters}—its natural frequencies, mode shapes, and damping ratios. Whether using mathematical modelling or experimental testing, modal analysis is key for engineers to understand the response of structures to various excitations or forces, ensuring safety, compliance with standards and regulations and supporting many research areas such as structural health monitoring or system identification.

Fundamentally, modal analysis is the decomposition of the complex oscillatory behaviour of structures into smaller, more intuitive components called \emph{modes}. Each mode is a mathematical representation of a specific vibration pattern associated with a \emph{natural frequency}, the frequency (or set of) at which a system tends to oscillate when displaced, and a corresponding \emph{mode shape}, a vector which describes the relative movement among the degrees-of-freedom (DOFs) or axis points. The \emph{damping ratio}, a unitless parameter, quantifies the energy dissipation of the system at these natural frequencies. The modal properties are defined by the interaction of the system's physical properties, its mass, stiffness, and damping. These inherent properties guide the system's vibration when subject to external forcing or initial displacements or velocities.

Based on the theory, the standard procedure for modal analysis begins with forming the equations of motion (EOMs) that represent a system, typically, second order matrix differential equations. Consider a system with an arbitrary number $N$, degrees-of-freedom as shown in figure \ref{fig:ndof-chain}. Using Newton's second law,
 $$\sum F_i = m_i\ddot{\mathbf{x}}_i$$ 
 Where $F_i$ is a force acting on the $i$-th DOF, $m_i$ is the mass, and $\mathbf{x}_i$ is the coordinate, or alternatively the Euler-Lagrange equation as such: 
 $$\frac{d}{dt}\left(\frac{\partial T}{\partial \dot{q}_i}\right) - \frac{\partial T}{\partial q_i} + \frac{\partial U}{\partial q_i} = Q_i$$
Where $q_i$ is a generalized coordinate (take $q_i = x_i$ for this system), $T$ is the system's kinetic energy, $U$ is the potential energy, and $Q_i$ represents the non-conservative forces. The resulting equations of motion for the system are given in Equation \ref{eq:ndof-eoms}.

\begin{equation}\label{eq:ndof-eoms}
    \begin{aligned}
        m_1\ddot{x}_1 + (c_1+c_2)\dot{x}_1 - c_2\dot{x}_2 + (k_1+k_2)x_1 -k_2x_2 & = F_1 \\
        m_2\ddot{x}_2 + (c_2+c_3)\dot{x}_1 - c_2\dot{x}_1 - c_3\dot{x_3} + (k_2+k_3)x_2 -k_2x_1 -k_3x_3 & = F_2\\
        \dots \hspace{5cm}\\
        m_N\ddot{x}_N + (c_N+c_{N+1})\dot{x}_N - c_{N-1}\dot{x}_{N-1} + (k_N+k_{N+1})x_N -k_{N-1}x_{N-1} & = F_{N}
    \end{aligned}
\end{equation}

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{Figures/n-dof-chain-sys.png}
    \caption{A "lumped-mass" system of $N$ degrees-of-freedom}
    \label{fig:ndof-chain}
\end{figure}

By assembling the physical parameters into respective matrices as highlighted in Equation \ref{eq:system-matrices}, the characteristic differential equation of the system is obtained:

\begin{equation}\label{eq:system-matrices}
    \begin{aligned}
        \relax [\mathbf{K}] &= \begin{bmatrix}
            k_1+k_2&-k_2 & 0 &\dots & 0\\
            -k_2&k_2+k_3&-k3&\dots &0\\
            0 & -k_3 & k_3+k_4& -k_4 &0\\
            \dots&\dots&\dots&\ddots &\dots\\
            0 & 0 & 0 & -k_{N} & k_{N}+k_{N+1}
        \end{bmatrix}\\
        [\mathbf{C}] &= \begin{bmatrix}
            c_1+c_2&-c_2 & 0 &\dots & 0\\
            -c_2&c_2+c_3&-c3&\dots &0\\
            0 & -c_3 & c_3+c_4& -c_4 &0\\
            \dots&\dots&\dots&\ddots &\dots\\
            0 & 0 & 0 & -c_{N} & c_{N}+c_{N+1}
        \end{bmatrix}\\
        [\mathbf{M}] &= \mathbf{diag}(m_i) \hspace{1cm} \forall i = 1,2,\dots,N
    \end{aligned}
\end{equation}
\begin{equation}\label{eq:general_damped_mdof}
    \therefore [\mathbf{M}]\mathbf{\ddot{x}}+[\mathbf{C}]\mathbf{\dot{x}}+[\mathbf{K}]\mathbf{x} = \mathbf{F}
\end{equation}

For simplicity, assume the system presented vibrates freely, and is undamped, so $\mathbf{F}$ and $[\mathbf{C}]$ are zero. If the solution of the presented differential equation is harmonic, i.e. $\mathbf{x}(t) = \Psi e^{j\omega t}$, one finds that equation \ref{eq:general_damped_mdof} reduces to:
\begin{equation}
    ([\mathbf{K}] - \omega^2[\mathbf{M}])\Psi = 0
\end{equation}
Rearranging the terms, the equation into takes the general form of an eigenvalue problem:
\begin{equation}
    \begin{aligned}
        \relax [\mathbf{A}]& =  [\mathbf{M}]^{-1}[\mathbf{K}]\\
        [\mathbf{A}]&\Psi = \omega^2\Psi
    \end{aligned}
\end{equation}
Here, $\omega^2$ is the eigenvalue of matrix $\mathbf{A}$  — often referred to as an \emph{eigenfrequency} — and $\Psi$ is the corresponding eigenvector representing the mode shape.

% In systems with a finite number of degrees of freedom—often referred to as discrete systems—the modal analysis is performed using the dynamical matrix $[\mathbf{A}]$, which encapsulates the system's inertial and elastic properties. Building upon the discrete case, into systems which are modelled as continuous functions, the physical parameters of the systems are distributed spatially. This results into partial differential equation which governs the motion, where  finite dimensional matrices are then replaced with linear operators. Consequently, an eigenvalue problem is formed differently, in terms of a differential operator, where the eigenvalues are still correspondent to the natural frequency, and the respective eigenfunctions are the modeshapes in the spacial domain.

In discrete systems, with a finite number of degrees of freedom, the modal analysis is performed using the matrix $[\mathbf{A}]$, which encapsulates the system's inertial and elastic properties. When extending the approach to continuous systems (systems described by continuous functions), the physical parameters are distributed spatially. This results in a partial differential equation that governs the motion, where finite-dimensional matrices are replaced by linear operators. Consequently, an eigenvalue problem is formed in terms of a differential operator, with eigenvalues corresponding to the natural frequencies* and the associated eigenfunctions representing the mode shapes in the spatial domain\footnote{An \emph{eigenvector}, or an \emph{eigenfunction}, of a matrix or linear operator defined on some vector/function space is any non-zero vector/function in said space that when multiplied or acted upon by the matrix/linear operator is equivalent to being multiplied by some scalar factor, said scalar factor is referred to as the \emph{eigenvalue}.}. For example this principle applied to transverse vibration of an Euler-Bernoulli beam yields the eigenvalue problem:
\begin{equation}\label{eq:eigenfunction-beam}
    \Delta^2Y(x) = \beta^4Y(x)
\end{equation}
where $\Delta$ is the Laplacian operator (i.e. second partial derivative in Cartesian coordinate system), and $\beta^4 = \frac{\omega^2}{c^2}$, in which $\omega$ is the natural frequency, and $c^2$ is the ratio of the beam's flexural rigidity and its inertia.

In both discrete and continuous cases, the process of reducing the governing equations into eigenvalue problems is mathematically elegant, robust, and applicable to all linear systems. Despite this approach's elegance, its practical applications rarely exist. Real world structures and systems seldom conform to the idealized assumptions of lumped-mass systems or Euler-Bernoulli beams with known boundary conditions, this discrepancy can be attributed to more complex geometries, or internal interactions between the components of a system. This limitation has incentivized both academics and practitioners to approach modal analysis differently.

\subsubsection{Modal Analysis in practice, industry, and academia}



\pagebreak
Report Story:\\
\textbf{Structural Dynamics in engineering}
\begin{itemize}
    \item How studying structural mechanics has helped us have safer, lighter, greener structures.
    \item Modal Analysis, is regarded as \textbf{the} solution for linear structural dynamics.
    \item Maths of modal analysis:
    \begin{itemize}
        \item EOM formulation.
        \item Eigendecomposition of state matrices.
        \item FRF in modal terms. (refer to plscf solution using that)
    \end{itemize}
    \item This is in various industries, home appliances, aero, civil/structural, acoustics etc.
    \item Experimental Modal Analysis king.
    \item Curve-fitting methods for modal analysis.
    \item The need for algorithms in practice.
\end{itemize}

Onto software usage in engineering contexts
\begin{itemize}
    \item engineers consistently rely on software tools, this is great as it streamlines the important processes.
    \item Important aspects of software dev. :
    \begin{itemize}
        \item logic/control flow
        \item complexities and big O notation
        \item unit testing and integration testing.
        \item version control.
        \item foss vs. prop. discuss why it's cheaper in long run, and better for everyone involved.
    \end{itemize}
    \item Revisit the aims and objectives.
\end{itemize}

\section{Algorithms / development:}
\textbf{maths-y bit}
\begin{itemize}
    \item lsce (brief)
    \item lscf (brief)
    \item plscf (important bits and refer to appendix for full derivation, use own notation and wording).
    \item Why the companion matrix solution works. $\mathbf{eig}(C(p)) = \lambda_i \rightarrow p(\lambda) = 0$
    \item here one must explain what poles are for a system.
    \item lsfd for modeshapes.
\end{itemize}

\textbf{software-y bit}
\begin{itemize}
    \item time complexity optimization. discuss that O notation doesn't always equal less time.
    \item unit testing, explain pytest stuff and fixturing and bla bla bla.
    \item using numpy (BLAS routines/subroutines)
    \item user facing code.
    \item formatting guidelines.
\end{itemize}



\section{Results}

\begin{itemize}
    \item plscf on simulated modal data.
    \begin{itemize}
        \item clean
        \item noisy
        \item slightly nonlinear data (mimo where $H_{ij} \approx H_{ji}$ but $H_{ij} \neq H_{ji}$)
        \item high dofs.
    \end{itemize}
    \item plscf on actual lab data.
    \item adam's plscf vs siemens lms polymax on same dataset.
    \item interpretation of stabilization diagram.
\end{itemize}


\begin{lstlisting}[style={Python}]
import numpy as np

def _make_polynomial_basis_fcn(
    polynomial_order: int, frequency_vector: np.ndarray, sampling_frequency: float
):
    """Function that creates a Polynomial Basis Function matrix

    Args:
        polynomial_order (int): Order of the polynomial created. i.e. if 2 then P(x) = a0 * x^0  +  a1 * x^1 + a2 * x^2
        in the case of pLSCF, Omega(w) = P(e^{jw _delta t})

        frequency_vector (np.ndarray): vector of frequencies measured or simulated, can be hz or rads-1.
        MUST be either a row or column vector/1D Array

    Returns:
        Polynomial basis function matrix.
    """
    # the polynomial basis function is actually the vandermonde matrix for the polynomials, A and B.
    dt = 1 / sampling_frequency  # Sampling rate
    s = np.exp(1.j*frequency_vector*dt) # this is the "x" in the polynomial
    return np.vander(x=s,N=polynomial_order+1,increasing=True)    
\end{lstlisting}

\pagebreak





Consider the Jacobian matrix, for a system with $n_{outputs} = 3$:
\begin{equation}
    J = \begin{pmatrix}
        X_1 & 0 & 0 & Y_1\\
        0 & X_2& 0 & Y_2\\
        0 & 0 & X_3 & Y_3
    \end{pmatrix}    
\end{equation}

\begin{equation}
    J^HJ = \begin{pmatrix}
        X_{1}^HX_1 & 0 & 0 & X_{1}^HY_1\\
        0 & X_{2}^HX_2 & 0 & X_{1}^HY_2\\
        0 & 0 & X_{2}^HX_2 & X_{1}^HY_3\\
        X_{1}^*Y_{1}^T & X_{2}^*Y_{2}^T & X_{3}^*Y_{3}^T & Y_{1}^HY_1+Y_{2}^HY_2+Y_{3}^HY_3\\
    \end{pmatrix}
\end{equation}
if:
$$    R_o = Re(X_{o}^HX_o) $$
$$    S_o = Re(X_{o}^HY_o)$$
$$    T_o = Re(Y_{o}^HY_o)$$
\begin{equation}
    2Re(J^HJ)\theta = 2Re\begin{pmatrix}
        X_{1}^HX_1 & 0 & 0 & X_{1}^HY_1\\
        0 & X_{2}^HX_2 & 0 & X_{1}^HY_2\\
        0 & 0 & X_{2}^HX_2 & X_{1}^HY_3\\
        X_{1}^*Y_{1}^T & X_{2}^*Y_{2}^T & X_{3}^*Y_{3}^T & Y_{1}^HY_1+Y_{2}^HY_2+Y_{3}^HY_3\\
    \end{pmatrix}
    \begin{pmatrix}
        \beta_1\\
        \beta_2\\
        \beta_3\\
        \alpha
    \end{pmatrix} 
\end{equation}
\begin{equation}
    = 
    2 \begin{pmatrix}
        R_1\beta_1+S_1\alpha\\
        R_2\beta_2+S_2\alpha\\
        R_3\beta_3+S_3\alpha\\
        S_{1}^T\beta_1+S_{2}^T\beta_2+S_{3}^T\beta_3 +(T_1+T_2+T_3)\alpha 
    \end{pmatrix}
\end{equation}

which corresponds to the solutions in the normal equations in terms of alpha and beta.


\begin{equation}
    l^{LS}(\theta) = tr\{\theta^TRe(J^HJ)\theta\}
\end{equation}

from vector calculus, if
\begin{equation}
    \mathbf{f}= \mathbf{x^TBx}
\end{equation}
then,
\begin{equation}
    \frac{\partial \mathbf{f}}{\partial \mathbf{x}} = 2\mathbf{Bx}
\end{equation}

then the normal equation for polymax should be:
\begin{equation}
    \frac{\partial l^{LS}}{\partial \theta} = 2Re(J^HJ)\theta
\end{equation}